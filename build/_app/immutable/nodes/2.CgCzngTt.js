import{t as Y,a as J}from"../chunks/DvQ0EMYy.js";import{i as ve}from"../chunks/FcGGXcPq.js";import{h as I,ak as fe,o as ue,al as de,A as ce,j as xe,B as pe,v as s,C as ge,G as o,P as me,D as f,a6 as x,W as b,F as u,a7 as p}from"../chunks/CIlVPoIB.js";import{l as be,e as k,s as C}from"../chunks/D0qaSZxu.js";import{i as he}from"../chunks/CJifIpwa.js";import{r as h}from"../chunks/KjKasaag.js";import{o as _e}from"../chunks/CZh9LFWM.js";const K=[...` 	
\r\fÂ \v\uFEFF`];function ye(r,d,n){var l=r==null?"":""+r;if(n){for(var i in n)if(n[i])l=l?l+" "+i:i;else if(l.length)for(var e=i.length,a=0;(a=l.indexOf(i,a))>=0;){var v=a+e;(a===0||K.includes(l[a-1]))&&(v===l.length||K.includes(l[v]))?l=(a===0?"":l.substring(0,a))+l.substring(v+1):a=v}}return l===""?null:l}function Q(r,d,n,l,i,e){var a=r.__className;if(I||a!==n||a===void 0){var v=ye(n,l,e);(!I||v!==r.getAttribute("class"))&&(v==null?r.removeAttribute("class"):r.className=v),r.__className=n}else if(e&&i!==e)for(var g in e){var y=!!e[g];(i==null||y!==!!i[g])&&r.classList.toggle(g,y)}return e}function _(r,d,n=d){var l=fe();be(r,"input",i=>{var e=i?r.defaultValue:r.value;if(e=F(r)?D(e):e,n(e),l&&e!==(e=d())){var a=r.selectionStart,v=r.selectionEnd;r.value=e??"",v!==null&&(r.selectionStart=a,r.selectionEnd=Math.min(v,r.value.length))}}),(I&&r.defaultValue!==r.value||ue(d)==null&&r.value)&&n(F(r)?D(r.value):r.value),de(()=>{var i=d();F(r)&&i===D(r.value)||r.type==="date"&&!i&&!r.value||i!==r.value&&(r.value=i??"")})}function F(r){var d=r.type;return d==="number"||d==="range"}function D(r){return r===""?null:+r}const ze=!0,Fe=Object.freeze(Object.defineProperty({__proto__:null,prerender:ze},Symbol.toStringTag,{value:"Module"}));var we=Y('<div class="overlay svelte-1zsxfr"><div class="spinner svelte-1zsxfr"></div> <div class="loading-text svelte-1zsxfr">Verifying license...</div></div>'),Ve=Y('<div class="card svelte-1zsxfr"><div class="header svelte-1zsxfr"><h2 class="svelte-1zsxfr">MeadCo ScriptX License Verification</h2> <h3 class="svelte-1zsxfr"> </h3></div> <div class="form-group with-label svelte-1zsxfr"><label class="group-label svelte-1zsxfr" for="license-input">GUID *</label> <input id="license-input" type="text" placeholder="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx" class="svelte-1zsxfr"></div> <div class="form-group with-label svelte-1zsxfr"><label class="group-label svelte-1zsxfr" for="url-input">Url *</label> <input id="url-input" type="text" placeholder="Warehouse or URI" class="svelte-1zsxfr"></div> <div class="header svelte-1zsxfr"><h2 class="svelte-1zsxfr">License Summary</h2></div> <div>Issued to: <strong class="svelte-1zsxfr"> </strong></div> <div><div class="form-group with-label svelte-1zsxfr"><label class="group-label svelte-1zsxfr" for="revision-input">Revision</label> <input readonly="" id="revision-input" type="number" class="svelte-1zsxfr"></div> <div class="form-group with-label svelte-1zsxfr"><label class="group-label svelte-1zsxfr" for="valid-from-input">Valid From</label> <input readonly="" id="valid-from-input" type="date" class="svelte-1zsxfr"></div> <div class="form-group with-label svelte-1zsxfr"><label class="group-label svelte-1zsxfr" for="valid-until-input">Valid Until</label> <input readonly="" id="valid-until-input" type="date" class="svelte-1zsxfr"></div></div> <div class="button-row svelte-1zsxfr"><button class="green verify-button svelte-1zsxfr"> </button> <button class="blue print-button svelte-1zsxfr">Details ...</button></div></div> <a href="/print" style="display:none" class="svelte-1zsxfr">Print</a> <!>',1);function De(r,d){ce(d,!1);let n=b(""),l=b(!1),i=b(!1),e=b({revision:0,from:"",to:"",company:"",guid:""}),a=b("0.0.0");_e(async()=>{console.log("onMount connect lite...."),MeadCo.ScriptX.Print.connectLite("http://127.0.0.1:41191",""),x(a,await new Promise((t,c)=>{MeadCo.ScriptX.Print.serviceVersionAsync(t,c)})),x(a,s(a).major+"."+s(a).minor+"."+s(a).revision),console.log("serviceVersion",s(a))});function v(t){return/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(t)}function g(){return typeof window<"u"?window.location.protocol==="https:":!1}function y(t){try{return t.toLowerCase()==="warehouse"?g()?"securewarehouse":t:new URL(t)}catch{return""}}async function Z(t,c){console.log("start verify"),x(l,!0),x(i,!1);try{let V=await new Promise((ne,oe)=>{MeadCo.ScriptX.Print.Licensing.applyAsync(t,0,c,ne,oe)});console.log("License details:",V),x(e,V),p(e,s(e).from=s(e).from.split("T")[0]),p(e,s(e).to=s(e).to.split("T")[0]),p(e,s(e).url=c),x(i,!0)}catch(V){x(i,!1),alert("An error occurred while verifying the license."),console.error(V)}finally{console.log("end verify"),x(l,!1)}}function ee(){if(!v(s(e).guid)){alert("Please enter a valid GUID for the license.");return}if(x(n,y(s(n))),s(n)===""){alert('Please enter "warehouse" or a valid URL.');return}Z(s(e).guid,s(n))}function re(){typeof window<"u"&&(sessionStorage.setItem("licenseData",JSON.stringify(s(e))),window.location.href="/print")}ve();var R=Ve(),S=xe(R),A=f(S),N=o(f(A),2),se=f(N);u(N),u(A);var L=o(A,2),X=o(f(L),2);h(X),u(L);var P=o(L,2),j=o(f(P),2);h(j),u(P);var z=o(P,4);let G;var O=o(f(z)),le=f(O,!0);u(O),u(z);var w=o(z,2);let T;var M=f(w),W=o(f(M),2);h(W),u(M);var U=o(M,2),$=o(f(U),2);h($),u(U);var E=o(U,2),q=o(f(E),2);h(q),u(E),u(w);var B=o(w,2),m=f(B),te=f(m,!0);u(m);var H=o(m,2);u(B),u(S);var ie=o(S,4);{var ae=t=>{var c=we();J(t,c)};he(ie,t=>{s(l)&&t(ae)})}pe((t,c)=>{C(se,`v1.0.0 using ScriptX Services for Windows PC v${s(a)??""}`),G=Q(z,1,"issued-to svelte-1zsxfr",null,G,t),C(le,s(e).company||"Not verified"),T=Q(w,1,"form-row svelte-1zsxfr",null,T,c),m.disabled=s(l),C(te,s(l)?"Verifying...":"Verify license"),H.disabled=!s(i)},[()=>({loading:s(l)}),()=>({loading:s(l)})],me),_(X,()=>s(e).guid,t=>p(e,s(e).guid=t)),_(j,()=>s(n),t=>x(n,t)),_(W,()=>s(e).revision,t=>p(e,s(e).revision=t)),_($,()=>s(e).from,t=>p(e,s(e).from=t)),_(q,()=>s(e).to,t=>p(e,s(e).to=t)),k("click",m,ee),k("click",H,re),J(r,R),ge()}export{De as component,Fe as universal};
