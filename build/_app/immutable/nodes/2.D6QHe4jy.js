import{t as Y,a as B}from"../chunks/CgtIvP4o.js";import{i as ce}from"../chunks/Ddisd3R5.js";import{h as I,al as de,t as fe,am as be,B as pe,k as xe,C as ge,w as t,D as qe,I as v,Q as me,F as d,a7 as u,X as g,G as f,a8 as x}from"../chunks/D-wryjgi.js";import{l as he,e as J,s as R}from"../chunks/D-E2lVHr.js";import{i as _e}from"../chunks/B2ET3CS3.js";import{r as h}from"../chunks/CTMF2TM4.js";import{o as ye}from"../chunks/Bo0lCHBO.js";import{g as we}from"../chunks/6Vzg_Rwk.js";const Q=[...` 	
\r\fÂ \v\uFEFF`];function Se(e,b,o){var i=e==null?"":""+e;if(o){for(var a in o)if(o[a])i=i?i+" "+a:a;else if(i.length)for(var s=a.length,n=0;(n=i.indexOf(a,n))>=0;){var l=n+s;(n===0||Q.includes(i[n-1]))&&(l===i.length||Q.includes(i[l]))?i=(n===0?"":i.substring(0,n))+i.substring(l+1):n=l}}return i===""?null:i}function K(e,b,o,i,a,s){var n=e.__className;if(I||n!==o||n===void 0){var l=Se(o,i,s);(!I||l!==e.getAttribute("class"))&&(l==null?e.removeAttribute("class"):e.className=l),e.__className=o}else if(s&&a!==s)for(var c in s){var y=!!s[c];(a==null||y!==!!a[c])&&e.classList.toggle(c,y)}return s}function _(e,b,o=b){var i=de();he(e,"input",a=>{var s=a?e.defaultValue:e.value;if(s=U(e)?F(s):s,o(s),i&&s!==(s=b())){var n=e.selectionStart,l=e.selectionEnd;e.value=s??"",l!==null&&(e.selectionStart=n,e.selectionEnd=Math.min(l,e.value.length))}}),(I&&e.defaultValue!==e.value||fe(b)==null&&e.value)&&o(U(e)?F(e.value):e.value),be(()=>{var a=b();U(e)&&a===F(e.value)||e.type==="date"&&!a&&!e.value||a!==e.value&&(e.value=a??"")})}function U(e){var b=e.type;return b==="number"||b==="range"}function F(e){return e===""?null:+e}const Ve=!0,De=Object.freeze(Object.defineProperty({__proto__:null,prerender:Ve},Symbol.toStringTag,{value:"Module"}));var Le=Y('<div class="overlay svelte-1b8lqqx"><div class="spinner svelte-1b8lqqx"></div> <div class="loading-text svelte-1b8lqqx">Verifying license...</div></div>'),Ae=Y('<div class="card svelte-1b8lqqx"><div class="header svelte-1b8lqqx"><h2 class="svelte-1b8lqqx">MeadCo ScriptX License Verification <a href="https://github.com/MeadCo/ScriptX-VerifyLicense" target="_blank" rel="noopener noreferrer" style="margin-left: 0.5em;" class="svelte-1b8lqqx"><img src="https://img.shields.io/badge/GitHub-Repo-blue?logo=github" alt="GitHub Repo" style="vertical-align: middle;" class="svelte-1b8lqqx"></a></h2> <h3 class="svelte-1b8lqqx"> </h3></div> <div class="form-group with-label svelte-1b8lqqx"><label class="group-label svelte-1b8lqqx" for="license-input">GUID *</label> <input id="license-input" type="text" placeholder="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx" class="svelte-1b8lqqx"></div> <div class="form-group with-label svelte-1b8lqqx"><label class="group-label svelte-1b8lqqx" for="url-input">Url *</label> <input id="url-input" type="text" placeholder="Warehouse or URI" class="svelte-1b8lqqx"></div> <div class="header svelte-1b8lqqx"><h2 class="svelte-1b8lqqx">License Summary</h2></div> <div>Issued to: <strong class="svelte-1b8lqqx"> </strong></div> <div><div class="form-group with-label svelte-1b8lqqx"><label class="group-label svelte-1b8lqqx" for="revision-input">Revision</label> <input readonly="" id="revision-input" type="number" class="svelte-1b8lqqx"></div> <div class="form-group with-label svelte-1b8lqqx"><label class="group-label svelte-1b8lqqx" for="valid-from-input">Valid From</label> <input readonly="" id="valid-from-input" type="date" class="svelte-1b8lqqx"></div> <div class="form-group with-label svelte-1b8lqqx"><label class="group-label svelte-1b8lqqx" for="valid-until-input">Valid Until</label> <input readonly="" id="valid-until-input" type="date" class="svelte-1b8lqqx"></div></div> <div class="button-row svelte-1b8lqqx"><button class="green verify-button svelte-1b8lqqx"> </button> <button class="blue print-button svelte-1b8lqqx">Details ...</button></div></div> <a href="print" style="display:none" class="svelte-1b8lqqx">Print</a> <!>',1);function Ge(e,b){pe(b,!1);let o=g(""),i=g(!1),a=g(!1),s=g(!1),n=!0,l=g({revision:0,from:"",to:"",company:"",guid:""}),c=g(" [.connecting..]");ye(async()=>{console.log("onMount connect lite....");try{MeadCo.ScriptX.Print.connectLite("http://127.0.0.1:41191",""),u(c,await new Promise((r,p)=>{MeadCo.ScriptX.Print.serviceVersionAsync(r,p)})),u(c,t(c).major+"."+t(c).minor+"."+t(c).revision),console.log("serviceVersion",t(c)),u(s,!0)}catch(r){console.log("error on connect: ",r),typeof r=="string"&&r.toLowerCase().includes("unauthorized")?(u(c," [.available.]"),u(s,!0),n=!1):(alert(r),u(c," [.failed..]"))}});function y(r){return/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(r)}function Z(){return typeof window<"u"?window.location.protocol==="https:":!1}function ee(r){try{return r.toLowerCase()==="warehouse"||r.toLowerCase()==="securewarehouse"?Z()&&n?"securewarehouse":r:new URL(r)}catch{return""}}async function le(r,p){console.log("start verify"),u(i,!0),u(a,!1);try{let m=await new Promise((ve,ue)=>{MeadCo.ScriptX.Print.Licensing.applyAsync(r,0,p,ve,ue)});console.log("License details:",m),u(l,m),x(l,t(l).from=t(l).from.split("T")[0]),x(l,t(l).to=t(l).to.split("T")[0]),x(l,t(l).url=p),u(a,!0)}catch(m){u(a,!1),alert("An error occurred while verifying the license: "+m),console.error(m)}finally{console.log("end verify"),u(i,!1)}}function te(){if(!y(t(l).guid)){alert("Please enter a valid GUID for the license.");return}if(u(o,ee(t(o))),t(o)===""){alert('Please enter "warehouse" or a valid URL.');return}le(t(l).guid,t(o))}function re(){typeof window<"u"&&(sessionStorage.setItem("licenseData",JSON.stringify(t(l))),we("/verify/print"))}ce();var X=Ae(),V=xe(X),L=d(V),D=v(d(L),2),ie=d(D);f(D),f(L);var A=v(L,2),G=v(d(A),2);h(G),f(A);var C=v(A,2),N=v(d(C),2);h(N),f(C);var w=v(C,4);let H;var O=v(d(w)),ae=d(O,!0);f(O),f(w);var S=v(w,2);let j;var P=d(S),T=v(d(P),2);h(T),f(P);var M=v(P,2),W=v(d(M),2);h(W),f(M);var $=v(M,2),z=v(d($),2);h(z),f($),f(S);var E=v(S,2),q=d(E),se=d(q,!0);f(q);var k=v(q,2);f(E),f(V);var oe=v(V,4);{var ne=r=>{var p=Le();B(r,p)};_e(oe,r=>{t(i)&&r(ne)})}ge((r,p)=>{R(ie,`v1.0.10 using ScriptX Services for Windows PC v${t(c)??""}`),H=K(w,1,"issued-to svelte-1b8lqqx",null,H,r),R(ae,t(l).company||"Not verified"),j=K(S,1,"form-row svelte-1b8lqqx",null,j,p),q.disabled=t(i)||!t(s),R(se,t(i)?"Verifying...":"Verify license"),k.disabled=!t(a)||!t(s)},[()=>({loading:t(i)}),()=>({loading:t(i)})],me),_(G,()=>t(l).guid,r=>x(l,t(l).guid=r)),_(N,()=>t(o),r=>u(o,r)),_(T,()=>t(l).revision,r=>x(l,t(l).revision=r)),_(W,()=>t(l).from,r=>x(l,t(l).from=r)),_(z,()=>t(l).to,r=>x(l,t(l).to=r)),J("click",q,te),J("click",k,re),B(e,X),qe()}export{Ge as component,De as universal};
