import{t as R,a as T}from"../chunks/CgtIvP4o.js";import{i as Ue}from"../chunks/Ddisd3R5.js";import{J as We,b as Ke,s as le,h as O,K as Qe,a as Ze,w as i,Q as Ee,r as $e,c as je,d as Ce,e as oe,i as G,R as et,f as Ae,g as Ie,p as tt,S as ve,V as Le,O as xe,W as at,X as H,Y as De,Z as it,_ as rt,$ as nt,a0 as st,a1 as lt,j as ot,a2 as vt,a3 as ct,a4 as dt,a5 as Te,a6 as ut,B as pt,k as ft,C as F,D as bt,I as u,F as c,a7 as N,a8 as ke,G as s,a9 as _t}from"../chunks/D-wryjgi.js";import{l as gt,e as J,s as x}from"../chunks/D-E2lVHr.js";import{i as we}from"../chunks/B2ET3CS3.js";import{r as mt,s as ht}from"../chunks/CTMF2TM4.js";import{o as yt}from"../chunks/Bo0lCHBO.js";import{g as St}from"../chunks/6Vzg_Rwk.js";function ce(a,t){return t}function Pt(a,t,e,o){for(var n=[],v=t.length,d=0;d<v;d++)nt(t[d].e,n,!0);var g=v>0&&n.length===0&&e!==null;if(g){var m=e.parentNode;st(m),m.append(e),o.clear(),A(a,t[0].prev,t[v-1].next)}lt(n,()=>{for(var S=0;S<v;S++){var r=t[S];g||(o.delete(r.k),A(a,r.prev,r.next)),ot(r.e,!g)}})}function de(a,t,e,o,n,v=null){var d=a,g={flags:t,items:new Map,first:null};{var m=a;d=O?le(Qe(m)):m.appendChild(We())}O&&Ze();var S=null,r=!1,P=Ee(()=>{var l=e();return it(l)?l:l==null?[]:Le(l)});Ke(()=>{var l=i(P),b=l.length;if(r&&b===0)return;r=b===0;let p=!1;if(O){var D=$e(d)===je;D!==(b===0)&&(d=Ce(),le(d),oe(!1),p=!0)}if(O){for(var C=null,f,h=0;h<b;h++){if(G.nodeType===8&&G.data===et){d=G,p=!0,oe(!1);break}var w=l[h],X=o(w,h);f=Ne(G,g,C,null,w,X,h,n,t,e),g.items.set(X,f),C=f}b>0&&le(Ce())}O||Mt(l,g,d,n,t,o,e),v!==null&&(b===0?S?Ae(S):S=Ie(()=>v(d)):S!==null&&tt(S,()=>{S=null})),p&&oe(!0),i(P)}),O&&(d=G)}function Mt(a,t,e,o,n,v,d){var g=a.length,m=t.items,S=t.first,r=S,P,l=null,b=[],p=[],D,C,f,h;for(h=0;h<g;h+=1){if(D=a[h],C=v(D,h),f=m.get(C),f===void 0){var w=r?r.e.nodes_start:e;l=Ne(w,t,l,l===null?t.first:l.next,D,C,h,o,n,d),m.set(C,l),b=[],p=[],r=l.next;continue}if(Ct(f,D,h),(f.e.f&ve)!==0&&Ae(f.e),f!==r){if(P!==void 0&&P.has(f)){if(b.length<p.length){var X=p[0],k;l=X.prev;var W=b[0],V=b[b.length-1];for(k=0;k<b.length;k+=1)Xe(b[k],X,e);for(k=0;k<p.length;k+=1)P.delete(p[k]);A(t,W.prev,V.next),A(t,l,W),A(t,V,X),r=X,l=V,h-=1,b=[],p=[]}else P.delete(f),Xe(f,r,e),A(t,f.prev,f.next),A(t,f,l===null?t.first:l.next),A(t,l,f),l=f;continue}for(b=[],p=[];r!==null&&r.k!==C;)(r.e.f&ve)===0&&(P??(P=new Set)).add(r),p.push(r),r=r.next;if(r===null)continue;f=r}b.push(f),l=f,r=f.next}if(r!==null||P!==void 0){for(var I=P===void 0?[]:Le(P);r!==null;)(r.e.f&ve)===0&&I.push(r),r=r.next;var K=I.length;if(K>0){var q=g===0?e:null;Pt(t,I,q,m)}}xe.first=t.first&&t.first.e,xe.last=l&&l.e}function Ct(a,t,e,o){at(a.v,t),a.i=e}function Ne(a,t,e,o,n,v,d,g,m,S){var r=(m&vt)!==0,P=(m&ct)===0,l=r?P?H(n):De(n):n,b=(m&rt)===0?d:De(d),p={i:b,v:l,k:v,a:null,e:null,prev:e,next:o};try{return p.e=Ie(()=>g(a,l,b,S),O),p.e.prev=e&&e.e,p.e.next=o&&o.e,e===null?t.first=p:(e.next=p,e.e.next=p.e),o!==null&&(o.prev=p,o.e.prev=p.e),p}finally{}}function Xe(a,t,e){for(var o=a.next?a.next.e.nodes_start:e,n=t?t.e.nodes_start:e,v=a.e.nodes_start;v!==o;){var d=dt(v);n.before(v),v=d}}function A(a,t,e){t===null?a.first=e:(t.next=e,t.e.next=e&&e.e),e!==null&&(e.prev=t,e.e.prev=t&&t.e)}function Oe(a,t,e){if(a.multiple)return kt(a,t);for(var o of a.options){var n=U(o);if(ut(n,t)){o.selected=!0;return}}(!e||t!==void 0)&&(a.selectedIndex=-1)}function xt(a,t){Te(()=>{var e=new MutationObserver(()=>{var o=a.__value;Oe(a,o)});return e.observe(a,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{e.disconnect()}})}function Dt(a,t,e=t){var o=!0;gt(a,"change",n=>{var v=n?"[selected]":":checked",d;if(a.multiple)d=[].map.call(a.querySelectorAll(v),U);else{var g=a.querySelector(v)??a.querySelector("option:not([disabled])");d=g&&U(g)}e(d)}),Te(()=>{var n=t();if(Oe(a,n,o),o&&n===void 0){var v=a.querySelector(":checked");v!==null&&(n=U(v),e(n))}a.__value=n,o=!1}),xt(a)}function kt(a,t){for(var e of a.options)e.selected=~t.indexOf(U(e))}function U(a){return"__value"in a?a.__value:a.value}const wt=!0,Yt=Object.freeze(Object.defineProperty({__proto__:null,prerender:wt},Symbol.toStringTag,{value:"Module"}));var Xt=R('<label class="option-checkbox svelte-147bt40"><input type="checkbox" disabled class="svelte-147bt40"> </label>'),Et=R('<li class="svelte-147bt40"> </li>'),At=R('<div class="license-details svelte-147bt40"><div class="detail-section company-section svelte-147bt40"><h2 class="license-h svelte-147bt40">License Holder</h2> <p class="company-name svelte-147bt40"> </p></div> <div class="detail-section svelte-147bt40"><h2 class="license-details-heading svelte-147bt40">License Details</h2> <div class="detail-grid svelte-147bt40" style="margin-bottom: 1rem"><div class="detail-item row-item svelte-147bt40"><span class="label svelte-147bt40">Downloaded from:</span> <span class="value svelte-147bt40"> </span></div></div> <div class="detail-grid svelte-147bt40"><div class="detail-item svelte-147bt40"><span class="label svelte-147bt40">License ID:</span> <span class="value svelte-147bt40"> </span></div> <div class="detail-item svelte-147bt40"><span class="label svelte-147bt40">Revision:</span> <span class="value svelte-147bt40"> </span></div> <div class="detail-item svelte-147bt40"><span class="label svelte-147bt40">Valid From:</span> <span class="value svelte-147bt40"> </span></div> <div class="detail-item svelte-147bt40"><span class="label svelte-147bt40">Valid Until:</span> <span class="value svelte-147bt40"> </span></div></div> <span class="label svelte-147bt40" style="margin-top:0.5rem;display:block;">License Options:</span> <div class="options-row svelte-147bt40"></div> <span class="label svelte-147bt40" style="margin-bottom:0.5rem;display:block;">Valid Domains:</span> <ul class="domains-list svelte-147bt40"></ul></div> <div class="detail-section footer-section svelte-147bt40"><p class="svelte-147bt40"> </p></div></div>'),It=R('<div class="no-data svelte-147bt40"><p class="svelte-147bt40">No license data available. Please verify a license first.</p> <button class="back-button svelte-147bt40">Return to License Verification</button></div>'),Lt=R('<option class="svelte-147bt40"> </option>'),Tt=R('<div class="overlay svelte-147bt40" role="status" aria-live="polite"><div class="spinner svelte-147bt40" aria-hidden="true"></div> <div class="printing-text svelte-147bt40">Printing ...</div></div>'),Nt=R('<div class="print-container svelte-147bt40" role="main" aria-labelledby="license-title"><div class="print-header svelte-147bt40"><h1 id="license-title" class="svelte-147bt40">MeadCo ScriptX License Information</h1> <div class="non-printable svelte-147bt40"><button class="back-button svelte-147bt40">Back</button> <button class="print-button svelte-147bt40"> </button></div></div> <!></div> <dialog id="printDialog" aria-labelledby="dialog-title" aria-describedby="dialog-desc" class="svelte-147bt40"><form method="dialog" class="dialog-content svelte-147bt40"><h2 id="dialog-title" class="svelte-147bt40">Print options</h2> <p id="dialog-desc" class="sr-only svelte-147bt40">Select a printer to use</p> <div class="printer-select-container svelte-147bt40"><label for="printer-select" style="font-weight: bold;" class="svelte-147bt40">Printer :</label> <select id="printer-select" style="margin-left: 0.5rem;" class="svelte-147bt40"></select></div> <div style="display: flex; justify-content: flex-end; gap: 0.5rem;" class="svelte-147bt40"><button type="button" class="print-button svelte-147bt40">Print</button> <button type="button" class="back-button svelte-147bt40">Cancel</button></div></form></dialog> <!>',1);function Gt(a,t){pt(t,!1);let e=H(null),o=H(!0),n=H([]),v=H(""),d="";const g="http://127.0.0.1:41191";let m=H(!1);const S={basicHtmlPrinting:"Basic HTML Printing",advancedPrinting:"Advanced Printing",enhancedFormatting:"Enhanced Formatting",printPdf:"PDF Printing",printRaw:"Direct Printing"};yt(async()=>{const _=MeadCo.ScriptX.Print,y=MeadCo.ScriptX.Print.Licensing,M=sessionStorage.getItem("licenseData");M&&(N(e,JSON.parse(M)),ke(e,i(e).from=i(e).from.split("T")[0]),ke(e,i(e).to=i(e).to.split("T")[0]),sessionStorage.removeItem("licenseData"));try{console.log("Initializing MeadCo ScriptX...",i(e)),y.connectLite(g,i(e).guid,i(e).revision,i(e).url),_.connectLite(g,i(e).guid),await MeadCo.ScriptX.InitAsync(),N(n,MeadCo.ScriptX.GetAvailablePrinters()),d=MeadCo.ScriptX.Print.printerName,console.log("Available printers:",i(n)),console.log("Default printer:",d),i(n)&&i(n).length>0&&N(v,i(n).includes(d)?d:i(n)[0]),MeadCo.ScriptX.Printing.header="",MeadCo.ScriptX.Printing.footer="&b&p/&P&b&d",MeadCo.ScriptX.Printing.pageSize="A4",MeadCo.ScriptX.Printing.orientation="portrait",MeadCo.ScriptX.Printing.printBackground=!1,MeadCo.ScriptX.Printing.SetMarginMeasure(1),MeadCo.ScriptX.Printing.topMargin=10,MeadCo.ScriptX.Printing.bottomMargin=10,MeadCo.ScriptX.Printing.leftMargin=10,MeadCo.ScriptX.Printing.rightMargin=10,N(o,!1)}catch(L){console.error("Error initializing MeadCo ScriptX:",L)}});function r(){St("/verify")}function P(){console.log("Opening print dialog"),document.getElementById("printDialog").showModal()}function l(){console.log("Closing dialog"),document.getElementById("printDialog").close()}async function b(){console.log("Printing to:",i(v)),l();try{N(m,!0),await new Promise((_,y)=>{MeadCo.ScriptX.Print.deviceSettingsForAsync(i(v),_,y)}),MeadCo.ScriptX.Print.printerName=i(v),MeadCo.ScriptX.PrintPage(!1),await MeadCo.ScriptX.WaitForSpoolingComplete()}catch(_){console.error("Error during print:",_),alert("An error occurred while printing. Please check your printer settings.")}finally{N(m,!1)}}Ue();var p=Nt(),D=ft(p),C=c(D),f=u(c(C),2),h=c(f),w=u(h,2),X=c(w,!0);s(w),s(f),s(C);var k=u(C,2);{var W=_=>{var y=At(),M=c(y),L=u(c(M),2),Z=c(L,!0);s(L),s(M);var $=u(M,2),j=u(c($),2),fe=c(j),be=u(c(fe),2),He=c(be,!0);s(be),s(fe),s(j);var ee=u(j,2),te=c(ee),_e=u(c(te),2),Ve=c(_e,!0);s(_e),s(te);var ae=u(te,2),ge=u(c(ae),2),qe=c(ge,!0);s(ge),s(ae);var ie=u(ae,2),me=u(c(ie),2),ze=c(me,!0);s(me),s(ie);var he=u(ie,2),ye=u(c(he),2),Ye=c(ye,!0);s(ye),s(he),s(ee);var re=u(ee,4);de(re,5,()=>Object.entries(i(e).options),ce,(z,B)=>{let E=()=>i(B)[0],Y=()=>i(B)[1];var ne=Xt(),se=c(ne);mt(se);var Je=u(se);s(ne),F(()=>{ht(se,Y()),x(Je,` ${(S[E()]||E())??""}`)}),T(z,ne)}),s(re);var Se=u(re,4);de(Se,5,()=>i(e).domains,ce,(z,B)=>{var E=Et(),Y=c(E,!0);s(E),F(()=>x(Y,i(B))),T(z,E)}),s(Se),s($);var Pe=u($,2),Me=c(Pe),Ge=c(Me);s(Me),s(Pe),s(y),F((z,B,E,Y)=>{x(Z,i(e).company||"Not specified"),x(He,i(e).url),x(Ve,i(e).guid),x(qe,i(e).revision),x(ze,z),x(Ye,B),x(Ge,`This license verification was performed on ${E??""} at ${Y??""}`)},[()=>new Date(i(e).from).toLocaleDateString(),()=>new Date(i(e).to).toLocaleDateString(),()=>new Date().toLocaleDateString(),()=>new Date().toLocaleTimeString()],Ee),T(_,y)},V=_=>{var y=It(),M=u(c(y),2);s(y),J("click",M,r),T(_,y)};we(k,_=>{i(e)?_(W):_(V,!1)})}s(D);var I=u(D,2),K=c(I),q=u(c(K),4),Q=u(c(q),2);F(()=>{i(v),_t(()=>{i(n)})}),de(Q,5,()=>i(n),ce,(_,y)=>{var M=Lt(),L={},Z=c(M,!0);s(M),F(()=>{L!==(L=i(y))&&(M.value=(M.__value=i(y))??""),x(Z,i(y))}),T(_,M)}),s(Q),s(q);var ue=u(q,2),pe=c(ue),Re=u(pe,2);s(ue),s(K),s(I);var Be=u(I,2);{var Fe=_=>{var y=Tt();T(_,y)};we(Be,_=>{i(m)&&_(Fe)})}F(()=>{w.disabled=i(o),x(X,i(o)?"Please wait":"Print")}),J("click",h,r),J("click",w,P),Dt(Q,()=>i(v),_=>N(v,_)),J("click",pe,b),J("click",Re,l),T(a,p),bt()}export{Gt as component,Yt as universal};
