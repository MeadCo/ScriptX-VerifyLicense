import{t as O,a as L}from"../chunks/DvQ0EMYy.js";import{i as Ue}from"../chunks/FcGGXcPq.js";import{I as We,b as Qe,s as le,h as N,J as Ze,a as $e,v as i,P as Xe,c as Ke,r as Me,d as oe,g as G,Q as je,e as Ee,f as Ae,p as et,R as ve,S as Ie,M as Ce,V as tt,W as H,X as xe,Y as at,Z as it,_ as rt,$ as nt,a0 as st,i as lt,a1 as ot,a2 as vt,a3 as dt,a4 as Le,a5 as ct,A as ut,j as pt,B,C as ft,G as u,D as v,a6 as T,a7 as De,F as s,a8 as _t}from"../chunks/CIlVPoIB.js";import{l as gt,e as J,s as C}from"../chunks/D0qaSZxu.js";import{i as ke}from"../chunks/CJifIpwa.js";import{r as yt,s as mt}from"../chunks/KjKasaag.js";import{o as bt}from"../chunks/CZh9LFWM.js";function de(a,t){return t}function ht(a,t,e,o){for(var n=[],d=t.length,c=0;c<d;c++)rt(t[c].e,n,!0);var g=d>0&&n.length===0&&e!==null;if(g){var m=e.parentNode;nt(m),m.append(e),o.clear(),E(a,t[0].prev,t[d-1].next)}st(n,()=>{for(var h=0;h<d;h++){var r=t[h];g||(o.delete(r.k),E(a,r.prev,r.next)),lt(r.e,!g)}})}function ce(a,t,e,o,n,d=null){var c=a,g={flags:t,items:new Map,first:null};{var m=a;c=N?le(Ze(m)):m.appendChild(We())}N&&$e();var h=null,r=!1,z=Xe(()=>{var l=e();return at(l)?l:l==null?[]:Ie(l)});Qe(()=>{var l=i(z),_=l.length;if(r&&_===0)return;r=_===0;let p=!1;if(N){var x=c.data===Ke;x!==(_===0)&&(c=Me(),le(c),oe(!1),p=!0)}if(N){for(var M=null,f,b=0;b<_;b++){if(G.nodeType===8&&G.data===je){c=G,p=!0,oe(!1);break}var k=l[b],w=o(k,b);f=Te(G,g,M,null,k,w,b,n,t,e),g.items.set(w,f),M=f}_>0&&le(Me())}N||zt(l,g,c,n,t,o,e),d!==null&&(_===0?h?Ee(h):h=Ae(()=>d(c)):h!==null&&et(h,()=>{h=null})),p&&oe(!0),i(z)}),N&&(c=G)}function zt(a,t,e,o,n,d,c){var g=a.length,m=t.items,h=t.first,r=h,z,l=null,_=[],p=[],x,M,f,b;for(b=0;b<g;b+=1){if(x=a[b],M=d(x,b),f=m.get(M),f===void 0){var k=r?r.e.nodes_start:e;l=Te(k,t,l,l===null?t.first:l.next,x,M,b,o,n,c),m.set(M,l),_=[],p=[],r=l.next;continue}if(Pt(f,x,b),(f.e.f&ve)!==0&&Ee(f.e),f!==r){if(z!==void 0&&z.has(f)){if(_.length<p.length){var w=p[0],D;l=w.prev;var W=_[0],F=_[_.length-1];for(D=0;D<_.length;D+=1)we(_[D],w,e);for(D=0;D<p.length;D+=1)z.delete(p[D]);E(t,W.prev,F.next),E(t,l,W),E(t,F,w),r=w,l=F,b-=1,_=[],p=[]}else z.delete(f),we(f,r,e),E(t,f.prev,f.next),E(t,f,l===null?t.first:l.next),E(t,l,f),l=f;continue}for(_=[],p=[];r!==null&&r.k!==M;)(r.e.f&ve)===0&&(z??(z=new Set)).add(r),p.push(r),r=r.next;if(r===null)continue;f=r}_.push(f),l=f,r=f.next}if(r!==null||z!==void 0){for(var A=z===void 0?[]:Ie(z);r!==null;)(r.e.f&ve)===0&&A.push(r),r=r.next;var Q=A.length;if(Q>0){var V=g===0?e:null;ht(t,A,V,m)}}Ce.first=t.first&&t.first.e,Ce.last=l&&l.e}function Pt(a,t,e,o){tt(a.v,t),a.i=e}function Te(a,t,e,o,n,d,c,g,m,h){var r=(m&ot)!==0,z=(m&vt)===0,l=r?z?H(n):xe(n):n,_=(m&it)===0?c:xe(c),p={i:_,v:l,k:d,a:null,e:null,prev:e,next:o};try{return p.e=Ae(()=>g(a,l,_,h),N),p.e.prev=e&&e.e,p.e.next=o&&o.e,e===null?t.first=p:(e.next=p,e.e.next=p.e),o!==null&&(o.prev=p,o.e.prev=p.e),p}finally{}}function we(a,t,e){for(var o=a.next?a.next.e.nodes_start:e,n=t?t.e.nodes_start:e,d=a.e.nodes_start;d!==o;){var c=dt(d);n.before(d),d=c}}function E(a,t,e){t===null?a.first=e:(t.next=e,t.e.next=e&&e.e),e!==null&&(e.prev=t,e.e.prev=t&&t.e)}function Ne(a,t,e){if(a.multiple)return Ct(a,t);for(var o of a.options){var n=U(o);if(ct(n,t)){o.selected=!0;return}}(!e||t!==void 0)&&(a.selectedIndex=-1)}function St(a,t){Le(()=>{var e=new MutationObserver(()=>{var o=a.__value;Ne(a,o)});return e.observe(a,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{e.disconnect()}})}function Mt(a,t,e=t){var o=!0;gt(a,"change",n=>{var d=n?"[selected]":":checked",c;if(a.multiple)c=[].map.call(a.querySelectorAll(d),U);else{var g=a.querySelector(d)??a.querySelector("option:not([disabled])");c=g&&U(g)}e(c)}),Le(()=>{var n=t();if(Ne(a,n,o),o&&n===void 0){var d=a.querySelector(":checked");d!==null&&(n=U(d),e(n))}a.__value=n,o=!1}),St(a)}function Ct(a,t){for(var e of a.options)e.selected=~t.indexOf(U(e))}function U(a){return"__value"in a?a.__value:a.value}const xt=!0,Ft=Object.freeze(Object.defineProperty({__proto__:null,prerender:xt},Symbol.toStringTag,{value:"Module"}));var Dt=O('<label class="option-checkbox svelte-78dz5y"><input type="checkbox" disabled class="svelte-78dz5y"> </label>'),kt=O('<li class="svelte-78dz5y"> </li>'),wt=O('<div class="license-details svelte-78dz5y"><div class="detail-section company-section svelte-78dz5y"><h2 class="license-h svelte-78dz5y">License Holder</h2> <p class="company-name svelte-78dz5y"> </p></div> <div class="detail-section svelte-78dz5y"><h2 style="margin-bottom: 0.1rem" class="svelte-78dz5y">License Details</h2> <div class="detail-grid svelte-78dz5y" style="margin-bottom: 1rem"><div class="detail-item row-item svelte-78dz5y"><span class="label svelte-78dz5y">Downloaded from:</span> <span class="value svelte-78dz5y"> </span></div></div> <div class="detail-grid svelte-78dz5y"><div class="detail-item svelte-78dz5y"><span class="label svelte-78dz5y">License ID:</span> <span class="value svelte-78dz5y"> </span></div> <div class="detail-item svelte-78dz5y"><span class="label svelte-78dz5y">Revision:</span> <span class="value svelte-78dz5y"> </span></div> <div class="detail-item svelte-78dz5y"><span class="label svelte-78dz5y">Valid From:</span> <span class="value svelte-78dz5y"> </span></div> <div class="detail-item svelte-78dz5y"><span class="label svelte-78dz5y">Valid Until:</span> <span class="value svelte-78dz5y"> </span></div></div> <span class="label svelte-78dz5y" style="margin-top:0.5rem;display:block;">License Options:</span> <div class="options-row svelte-78dz5y"></div> <span class="label svelte-78dz5y" style="margin-bottom:0.5rem;display:block;">Valid Domains:</span> <ul class="domains-list svelte-78dz5y"></ul></div> <div class="detail-section footer-section svelte-78dz5y"><p class="svelte-78dz5y"> </p></div></div>'),Xt=O('<div class="no-data svelte-78dz5y"><p class="svelte-78dz5y">No license data available. Please verify a license first.</p> <button class="back-button svelte-78dz5y">Return to License Verification</button></div>'),Et=O('<option class="svelte-78dz5y"> </option>'),At=O('<div class="overlay svelte-78dz5y"><div class="spinner svelte-78dz5y"></div> <div class="printing-text svelte-78dz5y">Printing ...</div></div>'),It=O('<div class="print-container svelte-78dz5y"><div class="print-header svelte-78dz5y"><h1 class="svelte-78dz5y">MeadCo ScriptX License Information</h1> <div class="non-printable svelte-78dz5y"><button class="back-button svelte-78dz5y">Back</button> <button class="print-button svelte-78dz5y"> </button></div></div> <!></div> <dialog id="printDialog" class="svelte-78dz5y"><form method="dialog" style="min-width: 320px;" class="svelte-78dz5y"><h2 class="svelte-78dz5y">Print options</h2> <div style="margin-bottom: 1rem;" class="svelte-78dz5y"><label for="printer-select" style="font-weight: bold;" class="svelte-78dz5y">Printer to use</label> <select id="printer-select" style="margin-left: 0.5rem;" class="svelte-78dz5y"></select></div> <div style="display: flex; justify-content: flex-end; gap: 0.5rem;" class="svelte-78dz5y"><button type="button" class="print-button svelte-78dz5y">Print</button> <button type="button" class="back-button svelte-78dz5y">Cancel</button></div></form></dialog> <!>',1);function Vt(a,t){ut(t,!1);let e=H(null),o=H(!0),n=H([]),d=H(""),c="";const g="http://127.0.0.1:41191";let m=H(!1);const h={basicHtmlPrinting:"Basic HTML Printing",advancedPrinting:"Advanced Printing",enhancedFormatting:"Enhanced Formatting",printPdf:"PDF Printing",printRaw:"Direct Printing"};bt(async()=>{const y=MeadCo.ScriptX.Print,P=MeadCo.ScriptX.Print.Licensing,S=sessionStorage.getItem("licenseData");S&&(T(e,JSON.parse(S)),De(e,i(e).from=i(e).from.split("T")[0]),De(e,i(e).to=i(e).to.split("T")[0]));try{console.log("Initializing MeadCo ScriptX...",i(e)),P.connectLite(g,i(e).guid,i(e).revision,i(e).url),y.connectLite(g,i(e).guid),await MeadCo.ScriptX.InitAsync(),T(n,MeadCo.ScriptX.GetAvailablePrinters()),c=MeadCo.ScriptX.Print.printerName,console.log("Available printers:",i(n)),console.log("Default printer:",c),i(n)&&i(n).length>0&&T(d,i(n).includes(c)?c:i(n)[0]),MeadCo.ScriptX.Printing.header="",MeadCo.ScriptX.Printing.footer="&b&p/&P&b&d",MeadCo.ScriptX.Printing.pageSize="A4",MeadCo.ScriptX.Printing.orientation="portrait",MeadCo.ScriptX.Printing.printBackground=!1,MeadCo.ScriptX.Printing.SetMarginMeasure(1),MeadCo.ScriptX.Printing.topMargin=10,MeadCo.ScriptX.Printing.bottomMargin=10,MeadCo.ScriptX.Printing.leftMargin=10,MeadCo.ScriptX.Printing.rightMargin=10,T(o,!1)}catch(I){console.error("Error initializing MeadCo ScriptX:",I)}});function r(){window.location.href="/"}function z(){console.log("Opening print dialog"),document.getElementById("printDialog").showModal()}function l(){console.log("Closing dialog"),document.getElementById("printDialog").close()}async function _(){console.log("Printing to:",i(d)),l();try{T(m,!0),MeadCo.ScriptX.Print.printerName=i(d),MeadCo.ScriptX.PrintPage(!1),await MeadCo.ScriptX.WaitForSpoolingComplete()}catch(y){console.error("Error during print:",y),alert("An error occurred while printing. Please check your printer settings.")}finally{T(m,!1)}}Ue();var p=It(),x=pt(p),M=v(x),f=u(v(M),2),b=v(f),k=u(b,2),w=v(k,!0);s(k),s(f),s(M);var D=u(M,2);{var W=y=>{var P=wt(),S=v(P),I=u(v(S),2),$=v(I,!0);s(I),s(S);var K=u(S,2),j=u(v(K),2),fe=v(j),_e=u(v(fe),2),He=v(_e,!0);s(_e),s(fe),s(j);var ee=u(j,2),te=v(ee),ge=u(v(te),2),Fe=v(ge,!0);s(ge),s(te);var ae=u(te,2),ye=u(v(ae),2),Ve=v(ye,!0);s(ye),s(ae);var ie=u(ae,2),me=u(v(ie),2),qe=v(me,!0);s(me),s(ie);var be=u(ie,2),he=u(v(be),2),Ye=v(he,!0);s(he),s(be),s(ee);var re=u(ee,4);ce(re,5,()=>Object.entries(i(e).options),de,(q,R)=>{let X=()=>i(R)[0],Y=()=>i(R)[1];var ne=Dt(),se=v(ne);yt(se);var Je=u(se);s(ne),B(()=>{mt(se,Y()),C(Je,` ${(h[X()]||X())??""}`)}),L(q,ne)}),s(re);var ze=u(re,4);ce(ze,5,()=>i(e).domains,de,(q,R)=>{var X=kt(),Y=v(X,!0);s(X),B(()=>C(Y,i(R))),L(q,X)}),s(ze),s(K);var Pe=u(K,2),Se=v(Pe),Ge=v(Se);s(Se),s(Pe),s(P),B((q,R,X,Y)=>{C($,i(e).company||"Not specified"),C(He,i(e).url),C(Fe,i(e).guid),C(Ve,i(e).revision),C(qe,q),C(Ye,R),C(Ge,`This license verification was performed on ${X??""} at ${Y??""}`)},[()=>new Date(i(e).from).toLocaleDateString(),()=>new Date(i(e).to).toLocaleDateString(),()=>new Date().toLocaleDateString(),()=>new Date().toLocaleTimeString()],Xe),L(y,P)},F=y=>{var P=Xt(),S=u(v(P),2);s(P),J("click",S,r),L(y,P)};ke(D,y=>{i(e)?y(W):y(F,!1)})}s(x);var A=u(x,2),Q=v(A),V=u(v(Q),2),Z=u(v(V),2);B(()=>{i(d),_t(()=>{i(n)})}),ce(Z,5,()=>i(n),de,(y,P)=>{var S=Et(),I={},$=v(S,!0);s(S),B(()=>{I!==(I=i(P))&&(S.value=(S.__value=i(P))??""),C($,i(P))}),L(y,S)}),s(Z),s(V);var ue=u(V,2),pe=v(ue),Oe=u(pe,2);s(ue),s(Q),s(A);var Re=u(A,2);{var Be=y=>{var P=At();L(y,P)};ke(Re,y=>{i(m)&&y(Be)})}B(()=>{k.disabled=i(o),C(w,i(o)?"Please wait":"Print")}),J("click",b,r),J("click",k,z),Mt(Z,()=>i(d),y=>T(d,y)),J("click",pe,_),J("click",Oe,l),L(a,p),ft()}export{Vt as component,Ft as universal};
