import{t as Y,a as B}from"../chunks/CgtIvP4o.js";import{i as ve}from"../chunks/Ddisd3R5.js";import{h as I,al as de,t as fe,am as he,B as pe,k as ge,C as me,w as l,D as be,I as u,Q as _e,F as d,a7 as c,X as m,G as f,a8 as g}from"../chunks/D-wryjgi.js";import{l as ye,e as J,s as R}from"../chunks/D-E2lVHr.js";import{i as xe}from"../chunks/B2ET3CS3.js";import{r as y}from"../chunks/CTMF2TM4.js";import{o as ke}from"../chunks/Bo0lCHBO.js";const Q=[...` 	
\r\fÂ \v\uFEFF`];function we(e,h,n){var i=e==null?"":""+e;if(n){for(var a in n)if(n[a])i=i?i+" "+a:a;else if(i.length)for(var s=a.length,o=0;(o=i.indexOf(a,o))>=0;){var t=o+s;(o===0||Q.includes(i[o-1]))&&(t===i.length||Q.includes(i[t]))?i=(o===0?"":i.substring(0,o))+i.substring(t+1):o=t}}return i===""?null:i}function K(e,h,n,i,a,s){var o=e.__className;if(I||o!==n||o===void 0){var t=we(n,i,s);(!I||t!==e.getAttribute("class"))&&(t==null?e.removeAttribute("class"):e.className=t),e.__className=n}else if(s&&a!==s)for(var v in s){var k=!!s[v];(a==null||k!==!!a[v])&&e.classList.toggle(v,k)}return s}function x(e,h,n=h){var i=de();ye(e,"input",a=>{var s=a?e.defaultValue:e.value;if(s=U(e)?F(s):s,n(s),i&&s!==(s=h())){var o=e.selectionStart,t=e.selectionEnd;e.value=s??"",t!==null&&(e.selectionStart=o,e.selectionEnd=Math.min(t,e.value.length))}}),(I&&e.defaultValue!==e.value||fe(h)==null&&e.value)&&n(U(e)?F(e.value):e.value),he(()=>{var a=h();U(e)&&a===F(e.value)||e.type==="date"&&!a&&!e.value||a!==e.value&&(e.value=a??"")})}function U(e){var h=e.type;return h==="number"||h==="range"}function F(e){return e===""?null:+e}const Se=!0,Ie=Object.freeze(Object.defineProperty({__proto__:null,prerender:Se},Symbol.toStringTag,{value:"Module"}));var Ve=Y('<div class="overlay svelte-hck95u"><div class="spinner svelte-hck95u"></div> <div class="loading-text svelte-hck95u">Verifying license...</div></div>'),Le=Y('<div class="card svelte-hck95u"><div class="header svelte-hck95u"><h2 class="svelte-hck95u">MeadCo ScriptX License Verification <a href="https://github.com/MeadCo/ScriptX-VerifyLicense" target="_blank" rel="noopener noreferrer" style="margin-left: 0.5em;" class="svelte-hck95u"><img src="https://img.shields.io/badge/GitHub-Repo-blue?logo=github" alt="GitHub Repo" style="vertical-align: middle;" class="svelte-hck95u"></a></h2> <h3 class="svelte-hck95u"> </h3></div> <div class="form-group with-label svelte-hck95u"><label class="group-label svelte-hck95u" for="license-input">GUID *</label> <input id="license-input" type="text" placeholder="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx" class="svelte-hck95u"></div> <div class="form-group with-label svelte-hck95u"><label class="group-label svelte-hck95u" for="url-input">Url *</label> <input id="url-input" type="text" placeholder="Warehouse or URI" class="svelte-hck95u"></div> <div class="header svelte-hck95u"><h2 class="svelte-hck95u">License Summary</h2></div> <div>Issued to: <strong class="svelte-hck95u"> </strong></div> <div><div class="form-group with-label svelte-hck95u"><label class="group-label svelte-hck95u" for="revision-input">Revision</label> <input readonly="" id="revision-input" type="number" class="svelte-hck95u"></div> <div class="form-group with-label svelte-hck95u"><label class="group-label svelte-hck95u" for="valid-from-input">Valid From</label> <input readonly="" id="valid-from-input" type="date" class="svelte-hck95u"></div> <div class="form-group with-label svelte-hck95u"><label class="group-label svelte-hck95u" for="valid-until-input">Valid Until</label> <input readonly="" id="valid-until-input" type="date" class="svelte-hck95u"></div></div> <div class="button-row svelte-hck95u"><button class="green verify-button svelte-hck95u"> </button> <button class="blue print-button svelte-hck95u">Details ...</button></div></div> <a href="print" style="display:none" class="svelte-hck95u">Print</a> <!>',1);function Xe(e,h){pe(h,!1);let n=m(""),i=m(!1),a=m(!1),s=m(!1),o=!0,t=m({revision:0,from:"",to:"",company:"",guid:""}),v=m(" [.connecting..]");ke(async()=>{console.log("onMount connect lite....");try{MeadCo.ScriptX.Print.connectLite("http://127.0.0.1:41191",""),c(v,await new Promise((r,p)=>{MeadCo.ScriptX.Print.serviceVersionAsync(r,p)})),c(v,l(v).major+"."+l(v).minor+"."+l(v).revision),console.log("serviceVersion",l(v)),c(s,!0)}catch(r){console.log("error on connect: ",r),typeof r=="string"&&r.toLowerCase().includes("unauthorized")?(c(v," [.available.]"),c(s,!0),o=!1):(alert(r),c(v," [.failed..]"))}});function k(r){return/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(r)}function Z(){return typeof window<"u"?window.location.protocol==="https:":!1}function ee(r){try{return r.toLowerCase()==="warehouse"||r.toLowerCase()==="securewarehouse"?Z()&&o?"securewarehouse":r:new URL(r)}catch{return""}}async function te(r,p){console.log("start verify"),c(i,!0),c(a,!1);try{let _=await new Promise((ue,ce)=>{MeadCo.ScriptX.Print.Licensing.applyAsync(r,0,p,ue,ce)});console.log("License details:",_),c(t,_),g(t,l(t).from=l(t).from.split("T")[0]),g(t,l(t).to=l(t).to.split("T")[0]),g(t,l(t).url=p),c(a,!0)}catch(_){c(a,!1),alert("An error occurred while verifying the license: "+_),console.error(_)}finally{console.log("end verify"),c(i,!1)}}function le(){if(!k(l(t).guid)){alert("Please enter a valid GUID for the license.");return}if(c(n,ee(l(n))),l(n)===""){alert('Please enter "warehouse" or a valid URL.');return}te(l(t).guid,l(n))}function re(){typeof window<"u"&&(sessionStorage.setItem("licenseData",JSON.stringify(l(t))),window.location.href="print.html")}ve();var X=Le(),V=ge(X),L=d(V),D=u(d(L),2),ie=d(D);f(D),f(L);var A=u(L,2),G=u(d(A),2);y(G),f(A);var C=u(A,2),N=u(d(C),2);y(N),f(C);var w=u(C,4);let H;var O=u(d(w)),ae=d(O,!0);f(O),f(w);var S=u(w,2);let j;var P=d(S),T=u(d(P),2);y(T),f(P);var M=u(P,2),W=u(d(M),2);y(W),f(M);var $=u(M,2),z=u(d($),2);y(z),f($),f(S);var E=u(S,2),b=d(E),se=d(b,!0);f(b);var q=u(b,2);f(E),f(V);var ne=u(V,4);{var oe=r=>{var p=Ve();B(r,p)};xe(ne,r=>{l(i)&&r(oe)})}me((r,p)=>{R(ie,`v1.0.9 using ScriptX Services for Windows PC v${l(v)??""}`),H=K(w,1,"issued-to svelte-hck95u",null,H,r),R(ae,l(t).company||"Not verified"),j=K(S,1,"form-row svelte-hck95u",null,j,p),b.disabled=l(i)||!l(s),R(se,l(i)?"Verifying...":"Verify license"),q.disabled=!l(a)||!l(s)},[()=>({loading:l(i)}),()=>({loading:l(i)})],_e),x(G,()=>l(t).guid,r=>g(t,l(t).guid=r)),x(N,()=>l(n),r=>c(n,r)),x(T,()=>l(t).revision,r=>g(t,l(t).revision=r)),x(W,()=>l(t).from,r=>g(t,l(t).from=r)),x(z,()=>l(t).to,r=>g(t,l(t).to=r)),J("click",b,le),J("click",q,re),B(e,X),be()}export{Xe as component,Ie as universal};
