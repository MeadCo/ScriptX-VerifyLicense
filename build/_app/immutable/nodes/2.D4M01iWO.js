import{t as Y,a as B}from"../chunks/CgtIvP4o.js";import{i as ce}from"../chunks/Ddisd3R5.js";import{h as I,al as ve,t as de,am as fe,B as he,k as pe,C as ge,w as l,D as me,I as u,Q as be,F as c,a7 as d,X as g,G as v,a8 as p}from"../chunks/D-wryjgi.js";import{l as _e,e as J,s as R}from"../chunks/D-E2lVHr.js";import{i as ye}from"../chunks/B2ET3CS3.js";import{r as y}from"../chunks/CTMF2TM4.js";import{o as xe}from"../chunks/Bo0lCHBO.js";const Q=[...` 	
\r\fÂ \v\uFEFF`];function ke(e,f,o){var i=e==null?"":""+e;if(o){for(var a in o)if(o[a])i=i?i+" "+a:a;else if(i.length)for(var s=a.length,t=0;(t=i.indexOf(a,t))>=0;){var n=t+s;(t===0||Q.includes(i[t-1]))&&(n===i.length||Q.includes(i[n]))?i=(t===0?"":i.substring(0,t))+i.substring(n+1):t=n}}return i===""?null:i}function K(e,f,o,i,a,s){var t=e.__className;if(I||t!==o||t===void 0){var n=ke(o,i,s);(!I||n!==e.getAttribute("class"))&&(n==null?e.removeAttribute("class"):e.className=n),e.__className=o}else if(s&&a!==s)for(var m in s){var k=!!s[m];(a==null||k!==!!a[m])&&e.classList.toggle(m,k)}return s}function x(e,f,o=f){var i=ve();_e(e,"input",a=>{var s=a?e.defaultValue:e.value;if(s=U(e)?F(s):s,o(s),i&&s!==(s=f())){var t=e.selectionStart,n=e.selectionEnd;e.value=s??"",n!==null&&(e.selectionStart=t,e.selectionEnd=Math.min(n,e.value.length))}}),(I&&e.defaultValue!==e.value||de(f)==null&&e.value)&&o(U(e)?F(e.value):e.value),fe(()=>{var a=f();U(e)&&a===F(e.value)||e.type==="date"&&!a&&!e.value||a!==e.value&&(e.value=a??"")})}function U(e){var f=e.type;return f==="number"||f==="range"}function F(e){return e===""?null:+e}const we=!0,Fe=Object.freeze(Object.defineProperty({__proto__:null,prerender:we},Symbol.toStringTag,{value:"Module"}));var Ve=Y('<div class="overlay svelte-hck95u"><div class="spinner svelte-hck95u"></div> <div class="loading-text svelte-hck95u">Verifying license...</div></div>'),Se=Y('<div class="card svelte-hck95u"><div class="header svelte-hck95u"><h2 class="svelte-hck95u">MeadCo ScriptX License Verification <a href="https://github.com/MeadCo/ScriptX-VerifyLicense" target="_blank" rel="noopener noreferrer" style="margin-left: 0.5em;" class="svelte-hck95u"><img src="https://img.shields.io/badge/GitHub-Repo-blue?logo=github" alt="GitHub Repo" style="vertical-align: middle;" class="svelte-hck95u"></a></h2> <h3 class="svelte-hck95u"> </h3></div> <div class="form-group with-label svelte-hck95u"><label class="group-label svelte-hck95u" for="license-input">GUID *</label> <input id="license-input" type="text" placeholder="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx" class="svelte-hck95u"></div> <div class="form-group with-label svelte-hck95u"><label class="group-label svelte-hck95u" for="url-input">Url *</label> <input id="url-input" type="text" placeholder="Warehouse or URI" class="svelte-hck95u"></div> <div class="header svelte-hck95u"><h2 class="svelte-hck95u">License Summary</h2></div> <div>Issued to: <strong class="svelte-hck95u"> </strong></div> <div><div class="form-group with-label svelte-hck95u"><label class="group-label svelte-hck95u" for="revision-input">Revision</label> <input readonly="" id="revision-input" type="number" class="svelte-hck95u"></div> <div class="form-group with-label svelte-hck95u"><label class="group-label svelte-hck95u" for="valid-from-input">Valid From</label> <input readonly="" id="valid-from-input" type="date" class="svelte-hck95u"></div> <div class="form-group with-label svelte-hck95u"><label class="group-label svelte-hck95u" for="valid-until-input">Valid Until</label> <input readonly="" id="valid-until-input" type="date" class="svelte-hck95u"></div></div> <div class="button-row svelte-hck95u"><button class="green verify-button svelte-hck95u"> </button> <button class="blue print-button svelte-hck95u">Details ...</button></div></div> <a href="print" style="display:none" class="svelte-hck95u">Print</a> <!>',1);function Ie(e,f){he(f,!1);let o=g(""),i=g(!1),a=g(!1),s=g(!1),t=g({revision:0,from:"",to:"",company:"",guid:""}),n=g(" [.connecting..]");xe(async()=>{console.log("onMount connect lite....");try{MeadCo.ScriptX.Print.connectLite("http://127.0.0.1:41191",""),d(n,await new Promise((r,h)=>{MeadCo.ScriptX.Print.serviceVersionAsync(r,h)})),d(n,l(n).major+"."+l(n).minor+"."+l(n).revision),console.log("serviceVersion",l(n)),d(s,!0)}catch(r){alert(r),d(n," [.failed..]")}});function m(r){return/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(r)}function k(){return typeof window<"u"?window.location.protocol==="https:":!1}function Z(r){try{return r.toLowerCase()==="warehouse"||r.toLowerCase()==="securewarehouse"?k()?"securewarehouse":r:new URL(r)}catch{return""}}async function ee(r,h){console.log("start verify"),d(i,!0),d(a,!1);try{let _=await new Promise((oe,ue)=>{MeadCo.ScriptX.Print.Licensing.applyAsync(r,0,h,oe,ue)});console.log("License details:",_),d(t,_),p(t,l(t).from=l(t).from.split("T")[0]),p(t,l(t).to=l(t).to.split("T")[0]),p(t,l(t).url=h),d(a,!0)}catch(_){d(a,!1),alert("An error occurred while verifying the license: "+_),console.error(_)}finally{console.log("end verify"),d(i,!1)}}function te(){if(!m(l(t).guid)){alert("Please enter a valid GUID for the license.");return}if(d(o,Z(l(o))),l(o)===""){alert('Please enter "warehouse" or a valid URL.');return}ee(l(t).guid,l(o))}function le(){typeof window<"u"&&(sessionStorage.setItem("licenseData",JSON.stringify(l(t))),window.location.href="print.html")}ce();var X=Se(),S=pe(X),L=c(S),D=u(c(L),2),re=c(D);v(D),v(L);var A=u(L,2),G=u(c(A),2);y(G),v(A);var P=u(A,2),N=u(c(P),2);y(N),v(P);var w=u(P,4);let O;var j=u(c(w)),ie=c(j,!0);v(j),v(w);var V=u(w,2);let H;var C=c(V),T=u(c(C),2);y(T),v(C);var M=u(C,2),$=u(c(M),2);y($),v(M);var E=u(M,2),W=u(c(E),2);y(W),v(E),v(V);var q=u(V,2),b=c(q),ae=c(b,!0);v(b);var z=u(b,2);v(q),v(S);var se=u(S,4);{var ne=r=>{var h=Ve();B(r,h)};ye(se,r=>{l(i)&&r(ne)})}ge((r,h)=>{R(re,`v1.0.8 using ScriptX Services for Windows PC v${l(n)??""}`),O=K(w,1,"issued-to svelte-hck95u",null,O,r),R(ie,l(t).company||"Not verified"),H=K(V,1,"form-row svelte-hck95u",null,H,h),b.disabled=l(i)||!l(s),R(ae,l(i)?"Verifying...":"Verify license"),z.disabled=!l(a)||!l(s)},[()=>({loading:l(i)}),()=>({loading:l(i)})],be),x(G,()=>l(t).guid,r=>p(t,l(t).guid=r)),x(N,()=>l(o),r=>d(o,r)),x(T,()=>l(t).revision,r=>p(t,l(t).revision=r)),x($,()=>l(t).from,r=>p(t,l(t).from=r)),x(W,()=>l(t).to,r=>p(t,l(t).to=r)),J("click",b,te),J("click",z,le),B(e,X),me()}export{Ie as component,Fe as universal};
